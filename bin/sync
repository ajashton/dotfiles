#!/usr/bin/env bash
cd "$(dirname "${BASH_SOURCE}")/.."

function sync_all() {

    aptitude install ${apt_packages[@]}

    rsync \
        --exclude ".git/" \
        --exclude ".gitmodules" \
        --exclude ".DS_Store" \
        --exclude "*.swp" \
        --exclude "README.md" \
        --exclude "bin" \
        -av --no-perms . ~

    ./bin/gsettings.sh

}

if [ "$1" == "--force" -o "$1" == "-f" ]; then
    sync_all
else
    read -p "This may overwrite existing files in your home directory. Are you sure? (y/n) " -n 1
    echo
    if [[ $REPLY =~ ^[Yy]$ ]]; then
        sync_all
    fi
fi

unset sync_all

source ~/.profile
